<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoLearn - Gamified Environmental Education</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2e7d32;
            --primary-light: #4caf50;
            --primary-dark: #1b5e20;
            --secondary: #ff9800;
            --accent: #8bc34a;
            --text: #333333;
            --text-light: #666666;
            --background: #f5f5f5;
            --card-bg: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        header {
            background-color: var(--primary);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .logo i {
            color: var(--accent);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: var(--primary-light);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 60px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 10px;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 25px;
        }

        .btn {
            display: inline-block;
            background-color: var(--secondary);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }

        .btn:hover {
            background-color: #e68900;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        /* Dashboard Sections */
        .dashboard-section {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-light);
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Progress Bar */
        .progress-container {
            margin: 15px 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .progress-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        /* Modules Grid */
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .module-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .module-card:hover {
            transform: translateY(-5px);
        }

        .module-header {
            background-color: var(--primary);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .module-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .module-icon {
            font-size: 1.5rem;
        }

        .module-body {
            padding: 15px;
        }

        .module-description {
            margin-bottom: 15px;
            color: var(--text-light);
        }

        .module-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        /* Challenges */
        .challenges-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .challenge-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: var(--card-bg);
            border-radius: 10px;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .challenge-item:hover {
            transform: translateX(5px);
        }

        .challenge-icon {
            width: 50px;
            height: 50px;
            background-color: var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.2rem;
        }

        .challenge-details {
            flex-grow: 1;
        }

        .challenge-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .challenge-description {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .challenge-points {
            background-color: var(--secondary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }

        /* Leaderboard */
        .leaderboard {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard th {
            background-color: var(--primary);
            color: white;
            padding: 12px 15px;
            text-align: left;
        }

        .leaderboard tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .leaderboard td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }

        .rank {
            font-weight: bold;
            color: var(--primary);
        }

        /* Login Form */
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .login-title {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .user-type-selector {
            display: flex;
            margin-bottom: 20px;
            border-radius: 5px;
            overflow: hidden;
        }

        .user-type {
            flex: 1;
            text-align: center;
            padding: 10px;
            background-color: #f0f0f0;
            cursor: pointer;
            border: 1px solid #ddd;
            transition: all 0.3s;
        }

        .user-type:first-child {
            border-radius: 5px 0 0 5px;
        }

        .user-type:last-child {
            border-radius: 0 5px 5px 0;
        }

        .user-type.active {
            background-color: var(--primary);
            color: white;
        }

        /* Badges */
        .badges-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .badge {
            width: 100px;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            background-color: var(--card-bg);
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .badge:hover {
            transform: scale(1.05);
        }

        .badge-icon {
            width: 60px;
            height: 60px;
            background-color: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            color: white;
            font-size: 1.5rem;
        }

        .badge-name {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .badge.earned .badge-icon {
            background-color: var(--primary);
        }

        /* Quiz */
        .quiz-container {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .quiz-question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .quiz-option {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            background-color: #f0f0f0;
        }

        .quiz-option.selected {
            background-color: var(--primary-light);
            color: white;
            border-color: var(--primary);
        }

        .quiz-result {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .quiz-result.success {
            background-color: #e8f5e9;
            color: var(--primary);
            display: block;
        }

        .quiz-result.failure {
            background-color: #ffebee;
            color: #d32f2f;
            display: block;
        }

        /* Lesson Content */
        .lesson-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .lesson-content h4 {
            margin-top: 20px;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .lesson-content ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .lesson-content li {
            margin-bottom: 8px;
        }

        /* Footer */
        footer {
            background-color: var(--primary-dark);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .footer-section {
            flex: 1;
            min-width: 250px;
            margin-bottom: 20px;
        }

        .footer-section h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 10px;
        }

        .footer-section a {
            color: #ddd;
            text-decoration: none;
        }

        .footer-section a:hover {
            color: white;
            text-decoration: underline;
        }

        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .modules-grid {
                grid-template-columns: 1fr;
            }

            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }

            .footer-content {
                flex-direction: column;
            }
        }

        /* Hidden class for toggling visibility */
        .hidden {
            display: none;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--primary);
            color: white;
            border-radius: 5px;
            box-shadow: var(--shadow);
            z-index: 1001;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Lesson Navigation */
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* XP Animation */
        .xp-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
            color: var(--secondary);
            z-index: 1002;
            animation: xpFloat 2s ease-out forwards;
            pointer-events: none;
        }

        @keyframes xpFloat {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -100%);
            }
        }

        /* Quiz Progress */
        .quiz-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }

        .question-counter {
            font-weight: bold;
            color: var(--primary);
        }

        .quiz-score {
            font-weight: bold;
            color: var(--secondary);
        }

        /* Quiz Results */
        .quiz-results {
            text-align: center;
            padding: 30px;
        }

        .quiz-results h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .quiz-results .score {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--secondary);
            margin: 20px 0;
        }

        .performance-message {
            margin: 20px 0;
            font-size: 1.1rem;
        }

        .performance-excellent {
            color: #2e7d32;
        }

        .performance-good {
            color: #ff9800;
        }

        .performance-average {
            color: #f57c00;
        }

        .performance-poor {
            color: #d32f2f;
        }

        /* Enhanced Teacher Dashboard Styles */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .analytics-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .analytics-title {
            font-size: 1rem;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .analytics-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .class-progress-chart {
            margin-top: 30px;
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .chart-container {
            height: 300px;
            margin-top: 20px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            justify-content: center;
        }

        .chart-bar {
            width: 40px;
            background-color: var(--primary);
            border-radius: 5px 5px 0 0;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            color: white;
            font-weight: bold;
            position: relative;
        }

        .chart-label {
            position: absolute;
            bottom: -25px;
            font-size: 0.8rem;
            color: var(--text-light);
            width: 100%;
            text-align: center;
        }

        .student-details {
            margin-top: 30px;
        }

        .student-details h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .student-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .student-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 15px;
            box-shadow: var(--shadow);
        }

        .student-name {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .student-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }

        .student-stat {
            text-align: center;
        }

        .student-stat-value {
            font-weight: bold;
            color: var(--primary);
        }

        .student-stat-label {
            font-size: 0.8rem;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- XP Animation -->
    <div id="xp-animation" class="xp-animation"></div>

    <!-- Header -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-leaf"></i>
                <span>EcoLearn</span>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="nav-link" data-target="dashboard">Dashboard</a></li>
                    <li><a href="#" class="nav-link" data-target="lessons">Lessons</a></li>
                    <li><a href="#" class="nav-link" data-target="challenges">Challenges</a></li>
                    <li><a href="#" class="nav-link" data-target="leaderboard">Leaderboard</a></li>
                    <li><a href="#" class="nav-link" data-target="rewards">Rewards</a></li>
                    <li><a href="#" class="nav-link teacher-only" data-target="teacher-dashboard">Teacher Dashboard</a></li>
                </ul>
            </nav>
            <div class="user-info">
                <div class="user-avatar" id="user-avatar">JS</div>
                <span id="username-display">John Student</span>
                <button id="logout-btn" class="btn">Logout</button>
            </div>
        </div>
    </header>

    <!-- Login Section -->
    <section id="login-section" class="container">
        <div class="login-container">
            <h2 class="login-title">Welcome to EcoLearn</h2>
            <div class="user-type-selector">
                <div class="user-type active" data-type="student">Student</div>
                <div class="user-type" data-type="teacher">Teacher</div>
            </div>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" class="form-control" placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" class="form-control" placeholder="Enter your password">
            </div>
            <button id="login-btn" class="btn" style="width: 100%;">Login</button>
            <p style="text-align: center; margin-top: 15px;">
                <small>Demo: Use any username/password to login</small>
            </p>
        </div>
    </section>

    <!-- Dashboard Content (initially hidden) -->
    <main id="main-content" class="container hidden">
        <!-- Hero Section -->
        <section class="hero">
            <h1>Learn. Act. Save Our Planet.</h1>
            <p>EcoLearn makes environmental education fun and impactful through interactive lessons and real-world challenges.</p>
            <a href="#" class="btn nav-link" data-target="lessons">Start Learning</a>
        </section>

        <!-- Dashboard Stats -->
        <section id="dashboard" class="dashboard-section">
            <div class="section-header">
                <h2 class="section-title">Your EcoLearn Dashboard</h2>
                <span id="user-role-display">Student</span>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <div class="stat-value" id="eco-points">450</div>
                    <div class="stat-label">Eco Points</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="stat-value" id="current-level">5</div>
                    <div class="stat-label">Current Level</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-value" id="completed-challenges">8</div>
                    <div class="stat-label">Completed Challenges</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <div class="stat-value" id="badges-earned">5</div>
                    <div class="stat-label">Badges Earned</div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-info">
                    <span>Next Level: Eco Warrior (Level 6)</span>
                    <span id="progress-percent">90%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="level-progress-fill" style="width: 90%;"></div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px;">Recent Activity</h3>
                <div class="challenges-list">
                    <div class="challenge-item">
                        <div class="challenge-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="challenge-details">
                            <div class="challenge-title">Completed Climate Change Quiz</div>
                            <div class="challenge-description">You scored 90% and earned 80 points</div>
                        </div>
                        <div class="challenge-points">+80</div>
                    </div>
                    <div class="challenge-item">
                        <div class="challenge-icon">
                            <i class="fas fa-tree"></i>
                        </div>
                        <div class="challenge-details">
                            <div class="challenge-title">Planted 5 Trees</div>
                            <div class="challenge-description">You completed the Tree Planting Challenge</div>
                        </div>
                        <div class="challenge-points">+200</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Lessons Section -->
        <section id="lessons" class="dashboard-section hidden">
            <div class="section-header">
                <h2 class="section-title">Interactive Lessons</h2>
                <span>Complete lessons to earn eco-points</span>
            </div>
            
            <div class="modules-grid">
                <div class="module-card">
                    <div class="module-header">
                        <div class="module-title">Climate Change</div>
                        <div class="module-icon"><i class="fas fa-cloud-sun"></i></div>
                    </div>
                    <div class="module-body">
                        <div class="module-description">
                            Understand the causes and effects of climate change and how we can mitigate them.
                        </div>
                        <div class="module-progress">
                            <span>Progress</span>
                            <span id="climate-progress">80%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="climate-progress-fill" style="width: 80%;"></div>
                        </div>
                        <button class="btn start-lesson" data-lesson="climate" style="width: 100%; margin-top: 15px;">Continue</button>
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-header">
                        <div class="module-title">Waste Management</div>
                        <div class="module-icon"><i class="fas fa-recycle"></i></div>
                    </div>
                    <div class="module-body">
                        <div class="module-description">
                            Learn about proper waste segregation, recycling, and reducing waste.
                        </div>
                        <div class="module-progress">
                            <span>Progress</span>
                            <span id="waste-progress">60%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="waste-progress-fill" style="width: 60%;"></div>
                        </div>
                        <button class="btn start-lesson" data-lesson="waste" style="width: 100%; margin-top: 15px;">Continue</button>
                    </div>
                </div>
                
                <div class="module-card">
                    <div class="module-header">
                        <div class="module-title">Biodiversity</div>
                        <div class="module-icon"><i class="fas fa-tree"></i></div>
                    </div>
                    <div class="module-body">
                        <div class="module-description">
                            Explore the importance of biodiversity and ecosystem conservation.
                        </div>
                        <div class="module-progress">
                            <span>Progress</span>
                            <span id="biodiversity-progress">40%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="biodiversity-progress-fill" style="width: 40%;"></div>
                        </div>
                        <button class="btn start-lesson" data-lesson="biodiversity" style="width: 100%; margin-top: 15px;">Continue</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Challenges Section -->
        <section id="challenges" class="dashboard-section hidden">
            <div class="section-header">
                <h2 class="section-title">Real-World Eco Challenges</h2>
                <span>Complete challenges to earn points and badges</span>
            </div>
            
            <div class="challenges-list">
                <div class="challenge-item">
                    <div class="challenge-icon">
                        <i class="fas fa-ban"></i>
                    </div>
                    <div class="challenge-details">
                        <div class="challenge-title">Plastic-Free Day</div>
                        <div class="challenge-description">Go one full day without using any single-use plastic items.</div>
                    </div>
                    <div class="challenge-points">50 pts</div>
                </div>
                
                <div class="challenge-item">
                    <div class="challenge-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="challenge-details">
                        <div class="challenge-title">Energy Saver</div>
                        <div class="challenge-description">Reduce your electricity consumption by 20% for one week.</div>
                    </div>
                    <div class="challenge-points">100 pts</div>
                </div>
                
                <div class="challenge-item">
                    <div class="challenge-icon">
                        <i class="fas fa-apple-alt"></i>
                    </div>
                    <div class="challenge-details">
                        <div class="challenge-title">Local Food Week</div>
                        <div class="challenge-description">Eat only locally sourced food for one week.</div>
                    </div>
                    <div class="challenge-points">150 pts</div>
                </div>
                
                <div class="challenge-item">
                    <div class="challenge-icon">
                        <i class="fas fa-tree"></i>
                    </div>
                    <div class="challenge-details">
                        <div class="challenge-title">Tree Planting Drive</div>
                        <div class="challenge-description">Plant at least 5 trees in your community.</div>
                    </div>
                    <div class="challenge-points">200 pts</div>
                </div>
                
                <div class="challenge-item">
                    <div class="challenge-icon">
                        <i class="fas fa-tint"></i>
                    </div>
                    <div class="challenge-details">
                        <div class="challenge-title">Water Conservation</div>
                        <div class="challenge-description">Reduce your water usage by 25% for one month.</div>
                    </div>
                    <div class="challenge-points">120 pts</div>
                </div>
            </div>
        </section>


<!-- Leaderboard Section -->
<section id="leaderboard" class="dashboard-section hidden">
  <div class="section-header">
    <h2 class="section-title">College Leaderboard</h2>
    <span>Top performing students and Colleges</span>
  </div>
  
  <table class="leaderboard">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Student</th>
        <th>College</th>
        <th>Points</th>
        <th>Badges</th>
      </tr>
    </thead>
    <tbody id="leaderboard-body">
      <tr>
        <td class="rank">1</td>
        <td>Priya Sharma</td>
        <td>Green Valley College</td>
        <td>980</td>
        <td>12</td>
      </tr>
      <tr>
        <td class="rank">2</td>
        <td>Rahul Kumar</td>
        <td>Eco Warriors Institute</td>
        <td>920</td>
        <td>10</td>
      </tr>
      <tr>
        <td class="rank">3</td>
        <td>Anjali Patel</td>
        <td>Nature's Pride College</td>
        <td>870</td>
        <td>9</td>
      </tr>
      <tr>
        <td class="rank">4</td>
        <td>Arun Singh</td>
        <td>Green Valley College</td>
        <td>820</td>
        <td>8</td>
      </tr>
      <tr>
        <td class="rank">5</td>
        <td>Meera Iyer</td>
        <td>Eco Warriors Institute</td>
        <td>740</td>
        <td>8</td>
      </tr>
      <tr>
        <td class="rank">6</td>
        <td id="current-user-name">John Student</td>
        <td>Green Valley College</td>
        <td id="current-user-points">650</td>
        <td id="current-user-badges">5</td>
      </tr>
    </tbody>
  </table>
</section>

<script>
document.addEventListener("DOMContentLoaded", function() {
  // Get the leaderboard table body
  const tableBody = document.getElementById("leaderboard-body");
  
  // Convert HTMLCollection to array for sorting
  const rows = Array.from(tableBody.getElementsByTagName("tr"));
  
  // Sort rows by points in descending order
  rows.sort((rowA, rowB) => {
    // Get points from the 4th cell (index 3) of each row
    const pointsA = parseInt(rowA.cells[3].textContent);
    const pointsB = parseInt(rowB.cells[3].textContent);
    
    // Sort in descending order (highest first)
    return pointsB - pointsA;
  });
  
  // Clear the current table body
  tableBody.innerHTML = '';
  
  // Add sorted rows back with updated ranks
  rows.forEach((row, index) => {
    // Update the rank in the first cell
    row.cells[0].textContent = index + 1;
    
    // Add the row back to the table
    tableBody.appendChild(row);
  });
});
</script>
        <!-- Rewards Section -->
        <section id="rewards" class="dashboard-section hidden">
            <div class="section-header">
                <h2 class="section-title">Your Rewards & Badges</h2>
                <span>Earn badges by completing lessons and challenges</span>
            </div>
            
            <div class="badges-container">
                <div class="badge earned">
                    <div class="badge-icon">
                        <i class="fas fa-seedling"></i>
                    </div>
                    <div class="badge-name">Eco Beginner</div>
                </div>
                <div class="badge earned">
                    <div class="badge-icon">
                        <i class="fas fa-recycle"></i>
                    </div>
                    <div class="badge-name">Waste Warrior</div>
                </div>
                <div class="badge earned">
                    <div class="badge-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="badge-name">Energy Saver</div>
                </div>
                <div class="badge earned">
                    <div class="badge-icon">
                        <i class="fas fa-tint"></i>
                    </div>
                    <div class="badge-name">Water Guardian</div>
                </div>
                <div class="badge earned">
                    <div class="badge-icon">
                        <i class="fas fa-tree"></i>
                    </div>
                    <div class="badge-name">Tree Hugger</div>
                </div>
                <div class="badge">
                    <div class="badge-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="badge-name">Eco Champion</div>
                </div>
                <div class="badge">
                    <div class="badge-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <div class="badge-name">Global Guardian</div>
                </div>
                <div class="badge">
                    <div class="badge-icon">
                        <i class="fas fa-award"></i>
                    </div>
                    <div class="badge-name">Sustainability Star</div>
                </div>
            </div>
        </section>

        <!-- Enhanced Teacher Dashboard Section -->
        <section id="teacher-dashboard" class="dashboard-section hidden">
            <div class="section-header">
                <h2 class="section-title">Teacher Dashboard</h2>
                <span>Monitor student progress and class performance</span>
            </div>
            
            <div class="analytics-grid">
                <div class="analytics-card">
                    <div class="analytics-title">Total Students</div>
                    <div class="analytics-value" id="total-students">32</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-title">Completion Rate</div>
                    <div class="analytics-value" id="completion-rate">78%</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-title">Total Eco Points</div>
                    <div class="analytics-value" id="total-eco-points">12,450</div>
                </div>
                <div class="analytics-card">
                    <div class="analytics-title">College Rank</div>
                    <div class="analytics-value" id="College-rank">3</div>
                </div>
            </div>

            <div class="class-progress-chart">
                <h3>Class Progress Overview</h3>
                <div class="chart-container" id="progress-chart">
                    <div class="chart-bar" style="height: 80%;">
                        80%
                        <div class="chart-label">Climate</div>
                    </div>
                    <div class="chart-bar" style="height: 60%;">
                        60%
                        <div class="chart-label">Waste</div>
                    </div>
                    <div class="chart-bar" style="height: 40%;">
                        40%
                        <div class="chart-label">Biodiversity</div>
                    </div>
                    <div class="chart-bar" style="height: 70%;">
                        70%
                        <div class="chart-label">Overall</div>
                    </div>
                </div>
            </div>

            <div class="student-details">
                <h3>Student Progress Details</h3>
                <div class="student-cards">
                    <div class="student-card">
                        <div class="student-name">John Student</div>
                        <div class="student-stats">
                            <div class="student-stat">
                                <div class="student-stat-value">8/12</div>
                                <div class="student-stat-label">Lessons</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">5/10</div>
                                <div class="student-stat-label">Challenges</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">450</div>
                                <div class="student-stat-label">Points</div>
                            </div>
                        </div>
                    </div>
                    <div class="student-card">
                        <div class="student-name">Sarah Johnson</div>
                        <div class="student-stats">
                            <div class="student-stat">
                                <div class="student-stat-value">10/12</div>
                                <div class="student-stat-label">Lessons</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">7/10</div>
                                <div class="student-stat-label">Challenges</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">620</div>
                                <div class="student-stat-label">Points</div>
                            </div>
                        </div>
                    </div>
                    <div class="student-card">
                        <div class="student-name">Michael Brown</div>
                        <div class="student-stats">
                            <div class="student-stat">
                                <div class="student-stat-value">6/12</div>
                                <div class="student-stat-label">Lessons</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">4/10</div>
                                <div class="student-stat-label">Challenges</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">380</div>
                                <div class="student-stat-label">Points</div>
                            </div>
                        </div>
                    </div>
                    <div class="student-card">
                        <div class="student-name">Emily Davis</div>
                        <div class="student-stats">
                            <div class="student-stat">
                                <div class="student-stat-value">11/12</div>
                                <div class="student-stat-label">Lessons</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">8/10</div>
                                <div class="student-stat-label">Challenges</div>
                            </div>
                            <div class="student-stat">
                                <div class="student-stat-value">720</div>
                                <div class="student-stat-label">Points</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px;">Detailed Student Progress</h3>
                <table class="leaderboard">
                    <thead>
                        <tr>
                            <th>Student</th>
                            <th>Lessons Completed</th>
                            <th>Challenges</th>
                            <th>Points</th>
                            <th>Badges</th>
                            <th>Progress</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>John Student</td>
                            <td>8/12</td>
                            <td>5/10</td>
                            <td>450</td>
                            <td>5</td>
                            <td>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 67%;"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Sarah Johnson</td>
                            <td>10/12</td>
                            <td>7/10</td>
                            <td>620</td>
                            <td>7</td>
                            <td>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 85%;"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Michael Brown</td>
                            <td>6/12</td>
                            <td>4/10</td>
                            <td>380</td>
                            <td>3</td>
                            <td>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 50%;"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Emily Davis</td>
                            <td>11/12</td>
                            <td>8/10</td>
                            <td>720</td>
                            <td>8</td>
                            <td>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 95%;"></div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Lesson Modal -->
    <div id="lesson-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="lesson-modal-title">Climate Change</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="lesson-content" class="lesson-content">
                <!-- Lesson content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div id="quiz-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="quiz-modal-title">Climate Change Quiz</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="quiz-content" class="lesson-content">
                <!-- Quiz content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container footer-content">
            <div class="footer-section">
                <h3>EcoLearn</h3>
                <p>Making environmental education fun, practical, and impactful for the next generation.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">How It Works</a></li>
                    <li><a href="#">Colleges</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Resources</h3>
                <ul>
                    <li><a href="#">Lesson Plans</a></li>
                    <li><a href="#">Teacher Guides</a></li>
                    <li><a href="#">Research</a></li>
                    <li><a href="#">FAQ</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <ul>
                    <li><a href="#"><i class="fab fa-facebook"></i> Facebook</a></li>
                    <li><a href="#"><i class="fab fa-twitter"></i> Twitter</a></li>
                    <li><a href="#"><i class="fab fa-instagram"></i> Instagram</a></li>
                    <li><a href="#"><i class="fab fa-youtube"></i> YouTube</a></li>
                </ul>
            </div>
        </div>
        <div class="container copyright">
            <p>&copy; 2024 EcoLearn. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Enhanced Database with proper progress tracking
        const ecoLearnDB = {
            currentUser: null,
            users: [
                { 
                    id: 1, 
                    username: 'Pawan', 
                    password: 'password', 
                    role: 'student', 
                    name: 'Pawan Student', 
                    points: 670, 
                    badges: 5, 
                    challenges: 8, 
                    College: 'Green Valley College', 
                    lessonProgress: {
                        climate: { completed: 4, total: 5, progress: 80 },
                        waste: { completed: 3, total: 5, progress: 60 },
                        biodiversity: { completed: 2, total: 5, progress: 40 }
                    },
                    quizProgress: {
                        climate: { score: 0, totalQuestions: 0, completed: false },
                        waste: { score: 0, totalQuestions: 0, completed: false },
                        biodiversity: { score: 0, totalQuestions: 0, completed: false }
                    }
                },
                { 
                    id: 2, 
                    username: 'teacher1', 
                    password: 'pass', 
                    role: 'teacher', 
                    name: 'Jane Teacher', 
                    points: 0, 
                    badges: 0, 
                    challenges: 0, 
                    College: 'Green Valley College' 
                }
            ],
            lessons: {
                climate: {
                    title: 'Climate Change',
                    content: [
                        {
                            type: 'content',
                            data: `
                                <h4>Understanding Climate Change</h4>
                                <p>Climate change refers to long-term shifts in temperatures and weather patterns. These shifts may be natural, but since the 1800s, human activities have been the main driver of climate change, primarily due to the burning of fossil fuels (like coal, oil, and gas), which produces heat-trapping gases.</p>
                                
                                <h4>Key Concepts</h4>
                                <ul>
                                    <li><strong>Greenhouse Effect:</strong> Natural process that warms the Earth's surface</li>
                                    <li><strong>Carbon Footprint:</strong> Total greenhouse gas emissions caused by an individual, event, organization, or product</li>
                                    <li><strong>Renewable Energy:</strong> Energy from sources that are naturally replenishing</li>
                                    <li><strong>Deforestation:</strong> Clearing of forests, contributing to increased CO2 levels</li>
                                </ul>
                                <div style="text-align: center; margin-top: 20px;">
                                    <button class="btn" id="start-climate-quiz">Take Climate Change Quiz</button>
                                </div>
                            `
                        }
                    ],
                    points: 50,
                    quiz: {
                        title: 'Climate Change Quiz',
                        questions: [
                            {
                                question: "What is the main cause of current climate change?",
                                options: [
                                    "Natural climate cycles",
                                    "Human activities like burning fossil fuels",
                                    "Changes in solar radiation",
                                    "Volcanic eruptions"
                                ],
                                correct: 1,
                                explanation: "While natural factors do influence climate, the current rapid warming is primarily caused by human activities, especially the burning of fossil fuels."
                            },
                            {
                                question: "Which of these is NOT a major impact of climate change?",
                                options: [
                                    "Rising sea levels",
                                    "More extreme weather events",
                                    "Decreased global temperatures",
                                    "Loss of biodiversity"
                                ],
                                correct: 2,
                                explanation: "Climate change is causing global temperatures to rise, not decrease. The other options are well-documented impacts of climate change."
                            },
                            {
                                question: "What is the greenhouse effect?",
                                options: [
                                    "A process that cools the Earth's surface",
                                    "A natural process that warms the Earth's surface",
                                    "The effect of greenhouses on plant growth",
                                    "A man-made process to control temperature"
                                ],
                                correct: 1,
                                explanation: "The greenhouse effect is a natural process where certain gases in the atmosphere trap heat, warming the Earth's surface."
                            },
                            {
                                question: "Which gas is primarily responsible for the enhanced greenhouse effect?",
                                options: [
                                    "Oxygen",
                                    "Nitrogen",
                                    "Carbon dioxide",
                                    "Helium"
                                ],
                                correct: 2,
                                explanation: "Carbon dioxide is the primary greenhouse gas responsible for the enhanced greenhouse effect due to human activities."
                            },
                            {
                                question: "What is the primary source of carbon dioxide emissions from human activities?",
                                options: [
                                    "Agriculture",
                                    "Burning fossil fuels",
                                    "Deforestation",
                                    "Industrial processes"
                                ],
                                correct: 1,
                                explanation: "Burning fossil fuels for energy is the primary source of carbon dioxide emissions from human activities."
                            },
                            {
                                question: "Which of these is a renewable energy source?",
                                options: [
                                    "Coal",
                                    "Natural gas",
                                    "Solar power",
                                    "Nuclear power"
                                ],
                                correct: 2,
                                explanation: "Solar power is a renewable energy source that doesn't produce greenhouse gas emissions during operation."
                            },
                            {
                                question: "What is the term for the long-term average of weather patterns?",
                                options: [
                                    "Weather",
                                    "Climate",
                                    "Atmosphere",
                                    "Environment"
                                ],
                                correct: 1,
                                explanation: "Climate refers to the long-term average of weather patterns in a specific region."
                            },
                            {
                                question: "Which of these is a consequence of melting polar ice caps?",
                                options: [
                                    "Decreased sea levels",
                                    "Increased freshwater availability",
                                    "Rising sea levels",
                                    "Cooler global temperatures"
                                ],
                                correct: 2,
                                explanation: "Melting polar ice caps contribute to rising sea levels, which can threaten coastal communities."
                            },
                            {
                                question: "What does the term 'carbon footprint' refer to?",
                                options: [
                                    "The amount of carbon in the atmosphere",
                                    "The total greenhouse gas emissions caused by an individual or organization",
                                    "The carbon content in fossil fuels",
                                    "The footprint left by carbon-based life forms"
                                ],
                                correct: 1,
                                explanation: "Carbon footprint refers to the total amount of greenhouse gases emitted directly or indirectly by an individual, organization, event, or product."
                            },
                            {
                                question: "Which international agreement aims to combat climate change?",
                                options: [
                                    "The Geneva Convention",
                                    "The Paris Agreement",
                                    "The Kyoto Protocol",
                                    "The Montreal Protocol"
                                ],
                                correct: 1,
                                explanation: "The Paris Agreement is an international treaty on climate change adopted in 2015, aiming to limit global warming."
                            },
                            {
                                question: "What is the main cause of ocean acidification?",
                                options: [
                                    "Plastic pollution",
                                    "Increased carbon dioxide absorption",
                                    "Oil spills",
                                    "Sewage discharge"
                                ],
                                correct: 1,
                                explanation: "Ocean acidification is primarily caused by the absorption of excess carbon dioxide from the atmosphere."
                            },
                            {
                                question: "Which of these is a mitigation strategy for climate change?",
                                options: [
                                    "Building sea walls",
                                    "Developing drought-resistant crops",
                                    "Switching to renewable energy",
                                    "Relocating coastal communities"
                                ],
                                correct: 2,
                                explanation: "Switching to renewable energy is a mitigation strategy that addresses the root cause of climate change by reducing greenhouse gas emissions."
                            },
                            {
                                question: "What is the primary greenhouse gas emitted by agricultural activities?",
                                options: [
                                    "Carbon dioxide",
                                    "Methane",
                                    "Nitrous oxide",
                                    "Water vapor"
                                ],
                                correct: 1,
                                explanation: "Methane is a potent greenhouse gas primarily emitted from livestock and rice cultivation."
                            },
                            {
                                question: "Which sector is the largest contributor to global greenhouse gas emissions?",
                                options: [
                                    "Agriculture",
                                    "Transportation",
                                    "Energy production",
                                    "Industrial processes"
                                ],
                                correct: 2,
                                explanation: "Energy production, particularly electricity and heat generation, is the largest contributor to global greenhouse gas emissions."
                            },
                            {
                                question: "What is the term for actions taken to adjust to the actual or expected effects of climate change?",
                                options: [
                                    "Mitigation",
                                    "Adaptation",
                                    "Prevention",
                                    "Resolution"
                                ],
                                correct: 1,
                                explanation: "Adaptation refers to actions taken to adjust to the actual or expected effects of climate change."
                            },
                            {
                                question: "Which of these is an example of climate change adaptation?",
                                options: [
                                    "Installing solar panels",
                                    "Building sea walls",
                                    "Planting trees",
                                    "Using electric vehicles"
                                ],
                                correct: 1,
                                explanation: "Building sea walls is an adaptation strategy to protect against rising sea levels caused by climate change."
                            },
                            {
                                question: "What is the main cause of deforestation?",
                                options: [
                                    "Natural forest fires",
                                    "Agricultural expansion",
                                    "Climate change",
                                    "Insect infestations"
                                ],
                                correct: 1,
                                explanation: "Agricultural expansion, particularly for cattle ranching and crop production, is the main cause of deforestation."
                            },
                            {
                                question: "How does deforestation contribute to climate change?",
                                options: [
                                    "By increasing oxygen levels",
                                    "By reducing carbon sequestration",
                                    "By cooling the planet",
                                    "By increasing cloud cover"
                                ],
                                correct: 1,
                                explanation: "Deforestation contributes to climate change by reducing the number of trees that can absorb and store carbon dioxide."
                            },
                            {
                                question: "What is the term for the ability of a system to cope with climate change impacts?",
                                options: [
                                    "Sustainability",
                                    "Resilience",
                                    "Durability",
                                    "Flexibility"
                                ],
                                correct: 1,
                                explanation: "Resilience refers to the ability of a system to cope with and recover from climate change impacts."
                            },
                            {
                                question: "Which of these is a consequence of climate change on biodiversity?",
                                options: [
                                    "Increased species diversity",
                                    "Shift in species distribution",
                                    "Decreased extinction rates",
                                    "Stable ecosystems"
                                ],
                                correct: 1,
                                explanation: "Climate change causes shifts in species distribution as they move to find suitable habitats, disrupting ecosystems."
                            }
                        ]
                    }
                },
                waste: {
                    title: 'Waste Management',
                    content: [
                        {
                            type: 'content',
                            data: `
                                <h4>Proper Waste Management</h4>
                                <p>Waste management involves the processes and actions required to manage waste from its inception to its final disposal. This includes the collection, transport, treatment, and disposal of waste, together with monitoring and regulation of the waste management process.</p>
                                
                                <h4>The 3 R's of Waste Management</h4>
                                <ul>
                                    <li><strong>Reduce:</strong> Minimizing waste generation by using less</li>
                                    <li><strong>Reuse:</strong> Using items multiple times before disposal</li>
                                    <li><strong>Recycle:</strong> Processing used materials into new products</li>
                                </ul>
                                <div style="text-align: center; margin-top: 20px;">
                                    <button class="btn" id="start-waste-quiz">Take Waste Management Quiz</button>
                                </div>
                            `
                        }
                    ],
                    points: 50,
                    quiz: {
                        title: 'Waste Management Quiz',
                        questions: [
                            {
                                question: "Which of these items should go in the blue recycling bin?",
                                options: [
                                    "Food scraps",
                                    "Plastic bottles",
                                    "Used batteries",
                                    "Garden waste"
                                ],
                                correct: 1,
                                explanation: "Plastic bottles are recyclable and belong in the blue bin. Food scraps and garden waste are compostable, while batteries are hazardous waste."
                            },
                            {
                                question: "What is the correct order of priority for the 3 R's?",
                                options: [
                                    "Recycle, Reuse, Reduce",
                                    "Reduce, Reuse, Recycle",
                                    "Reuse, Recycle, Reduce",
                                    "Reduce, Recycle, Reuse"
                                ],
                                correct: 1,
                                explanation: "The correct order is Reduce (minimize waste generation), Reuse (use items multiple times), Recycle (process materials into new products)."
                            },
                            {
                                question: "What is composting?",
                                options: [
                                    "Burning waste to generate energy",
                                    "A natural process that turns organic material into nutrient-rich soil",
                                    "Sorting waste into different categories",
                                    "Breaking down plastic materials"
                                ],
                                correct: 1,
                                explanation: "Composting is a natural process that turns organic material like food scraps and yard waste into nutrient-rich soil amendment."
                            },
                            {
                                question: "Which of these materials takes the longest to decompose in a landfill?",
                                options: [
                                    "Paper",
                                    "Food waste",
                                    "Plastic bottles",
                                    "Cotton clothing"
                                ],
                                correct: 2,
                                explanation: "Plastic bottles can take up to 450 years to decompose in a landfill, much longer than other common waste materials."
                            },
                            {
                                question: "What is the main environmental problem caused by plastic waste?",
                                options: [
                                    "It produces methane gas",
                                    "It releases toxic chemicals when burned",
                                    "It doesn't biodegrade and accumulates in ecosystems",
                                    "It consumes too much space in landfills"
                                ],
                                correct: 2,
                                explanation: "Plastic doesn't biodegrade and accumulates in ecosystems, causing harm to wildlife and polluting environments."
                            },
                            {
                                question: "Which of these is an example of reusing?",
                                options: [
                                    "Turning plastic bottles into fleece fabric",
                                    "Using a glass jar as a storage container",
                                    "Shredding paper to make new paper products",
                                    "Burning waste to generate electricity"
                                ],
                                correct: 1,
                                explanation: "Using a glass jar as a storage container is an example of reusing, as the item is used again for the same or different purpose without processing."
                            },
                            {
                                question: "What is the purpose of a landfill?",
                                options: [
                                    "To burn waste efficiently",
                                    "To compost organic materials",
                                    "To safely dispose of non-recyclable waste",
                                    "To sort recyclable materials"
                                ],
                                correct: 2,
                                explanation: "Landfills are engineered sites designed for the safe disposal of non-recyclable and non-compostable waste."
                            },
                            {
                                question: "Which of these is considered hazardous waste?",
                                options: [
                                    "Food scraps",
                                    "Paper products",
                                    "Batteries",
                                    "Glass containers"
                                ],
                                correct: 2,
                                explanation: "Batteries contain toxic chemicals and heavy metals, making them hazardous waste that requires special disposal."
                            },
                            {
                                question: "What is the main benefit of recycling aluminum cans?",
                                options: [
                                    "It saves energy compared to producing new aluminum",
                                    "It creates more jobs than other recycling processes",
                                    "It reduces the need for mining bauxite ore",
                                    "All of the above"
                                ],
                                correct: 3,
                                explanation: "Recycling aluminum saves energy, reduces the need for mining, and creates economic opportunities."
                            },
                            {
                                question: "Which of these is NOT a common method of waste disposal?",
                                options: [
                                    "Landfilling",
                                    "Incineration",
                                    "Composting",
                                    "Evaporation"
                                ],
                                correct: 3,
                                explanation: "Evaporation is not a common method of waste disposal. Landfilling, incineration, and composting are standard methods."
                            },
                            {
                                question: "What is the term for converting waste materials into new products?",
                                options: [
                                    "Reducing",
                                    "Reusing",
                                    "Recycling",
                                    "Recovering"
                                ],
                                correct: 2,
                                explanation: "Recycling involves converting waste materials into new products, reducing the need for virgin materials."
                            },
                            {
                                question: "Which of these materials is typically NOT accepted in curbside recycling programs?",
                                options: [
                                    "Cardboard boxes",
                                    "Glass bottles",
                                    "Plastic bags",
                                    "Aluminum cans"
                                ],
                                correct: 2,
                                explanation: "Plastic bags often clog recycling machinery and are typically not accepted in curbside recycling programs."
                            },
                            {
                                question: "What is the main environmental benefit of composting?",
                                options: [
                                    "It reduces greenhouse gas emissions from landfills",
                                    "It creates energy from waste",
                                    "It eliminates the need for recycling",
                                    "It reduces water consumption"
                                ],
                                correct: 0,
                                explanation: "Composting reduces methane emissions from landfills and creates nutrient-rich soil instead of waste."
                            },
                            {
                                question: "Which country has implemented one of the most successful waste management systems?",
                                options: [
                                    "United States",
                                    "China",
                                    "Sweden",
                                    "India"
                                ],
                                correct: 2,
                                explanation: "Sweden has implemented one of the most successful waste management systems, with less than 1% of household waste going to landfills."
                            },
                            {
                                question: "What is the term for the process of burning waste to generate energy?",
                                options: [
                                    "Pyrolysis",
                                    "Incineration",
                                    "Gasification",
                                    "Combustion"
                                ],
                                correct: 1,
                                explanation: "Incineration is the process of burning waste to generate energy, often called waste-to-energy."
                            },
                            {
                                question: "Which of these is an example of electronic waste (e-waste)?",
                                options: [
                                    "Food packaging",
                                    "Old computers and smartphones",
                                    "Newspapers and magazines",
                                    "Clothing and textiles"
                                ],
                                correct: 1,
                                explanation: "Old computers, smartphones, and other electronic devices are considered e-waste."
                            },
                            {
                                question: "What is the main challenge with recycling mixed materials?",
                                options: [
                                    "They are too heavy to transport",
                                    "They cannot be separated efficiently",
                                    "They produce toxic fumes when processed",
                                    "They are not valuable enough to recycle"
                                ],
                                correct: 1,
                                explanation: "Mixed materials are difficult to separate efficiently, making recycling challenging and often uneconomical."
                            },
                            {
                                question: "Which of these practices helps reduce waste at the source?",
                                options: [
                                    "Buying products with minimal packaging",
                                    "Sorting waste for recycling",
                                    "Composting food scraps",
                                    "Using reusable bags"
                                ],
                                correct: 0,
                                explanation: "Buying products with minimal packaging reduces waste at the source, which is more effective than managing waste after it's created."
                            },
                            {
                                question: "What is the term for the breakdown of materials by microorganisms?",
                                options: [
                                    "Decomposition",
                                    "Combustion",
                                    "Oxidation",
                                    "Erosion"
                                ],
                                correct: 0,
                                explanation: "Decomposition is the process where microorganisms break down organic materials into simpler substances."
                            },
                            {
                                question: "Which of these is a benefit of proper waste management?",
                                options: [
                                    "Reduced pollution",
                                    "Conservation of resources",
                                    "Public health protection",
                                    "All of the above"
                                ],
                                correct: 3,
                                explanation: "Proper waste management reduces pollution, conserves resources, and protects public health."
                            }
                        ]
                    }
                },
                biodiversity: {
                    title: 'Biodiversity',
                    content: [
                        {
                            type: 'content',
                            data: `
                                <h4>What is Biodiversity?</h4>
                                <p>Biodiversity refers to the variety of life on Earth at all its levels, from genes to ecosystems, and can encompass the evolutionary, ecological, and cultural processes that sustain life.</p>
                                
                                <h4>Types of Biodiversity</h4>
                                <ul>
                                    <li><strong>Genetic Diversity:</strong> Variety of genes within a species</li>
                                    <li><strong>Species Diversity:</strong> Variety of species within a habitat or region</li>
                                    <li><strong>Ecosystem Diversity:</strong> Variety of ecosystems in a given place</li>
                                </ul>
                                <div style="text-align: center; margin-top: 20px;">
                                    <button class="btn" id="start-biodiversity-quiz">Take Biodiversity Quiz</button>
                                </div>
                            `
                        }
                    ],
                    points: 50,
                    quiz: {
                        title: 'Biodiversity Quiz',
                        questions: [
                            {
                                question: "Which of these is NOT a type of biodiversity?",
                                options: [
                                    "Genetic diversity",
                                    "Species diversity",
                                    "Economic diversity",
                                    "Ecosystem diversity"
                                ],
                                correct: 2,
                                explanation: "Economic diversity is not a type of biodiversity. The three main types of biodiversity are genetic, species, and ecosystem diversity."
                            },
                            {
                                question: "Which ecosystem service is directly provided by biodiversity?",
                                options: [
                                    "Pollination of crops",
                                    "Manufacturing of electronics",
                                    "Internet connectivity",
                                    "Road construction"
                                ],
                                correct: 0,
                                explanation: "Pollination is an ecosystem service provided by diverse species like bees, butterflies, and other pollinators. The other options are human-made services."
                            },
                            {
                                question: "What is the term for a species that is native to a specific geographic location?",
                                options: [
                                    "Invasive species",
                                    "Endemic species",
                                    "Keystone species",
                                    "Indicator species"
                                ],
                                correct: 1,
                                explanation: "Endemic species are those that are native to and found only in a specific geographic location."
                            },
                            {
                                question: "Which of these is a major threat to biodiversity?",
                                options: [
                                    "Habitat destruction",
                                    "Climate change",
                                    "Pollution",
                                    "All of the above"
                                ],
                                correct: 3,
                                explanation: "Habitat destruction, climate change, and pollution are all major threats to biodiversity worldwide."
                            },
                            {
                                question: "What is the term for the variety of ecosystems in a given area?",
                                options: [
                                    "Genetic diversity",
                                    "Species diversity",
                                    "Ecosystem diversity",
                                    "Biological diversity"
                                ],
                                correct: 2,
                                explanation: "Ecosystem diversity refers to the variety of ecosystems in a given area, such as forests, wetlands, and grasslands."
                            },
                            {
                                question: "Which of these is an example of an invasive species?",
                                options: [
                                    "Panda in China",
                                    "Kangaroo in Australia",
                                    "Zebra mussel in the Great Lakes",
                                    "Polar bear in the Arctic"
                                ],
                                correct: 2,
                                explanation: "Zebra mussels are an invasive species in the Great Lakes, where they disrupt native ecosystems."
                            },
                            {
                                question: "What percentage of species on Earth are estimated to be insects?",
                                options: [
                                    "10%",
                                    "30%",
                                    "50%",
                                    "80%"
                                ],
                                correct: 3,
                                explanation: "Approximately 80% of the world's species are insects, making them the most diverse group of organisms."
                            },
                            {
                                question: "Which of these is a biodiversity hotspot?",
                                options: [
                                    "Sahara Desert",
                                    "Amazon Rainforest",
                                    "Antarctica",
                                    "Siberian Tundra"
                                ],
                                correct: 1,
                                explanation: "The Amazon Rainforest is a biodiversity hotspot with an incredibly high number of species found nowhere else."
                            },
                            {
                                question: "What is the term for the role a species plays in its ecosystem?",
                                options: [
                                    "Niche",
                                    "Habitat",
                                    "Territory",
                                    "Domain"
                                ],
                                correct: 0,
                                explanation: "A niche refers to the role a species plays in its ecosystem, including how it gets food and interacts with other species."
                            },
                            {
                                question: "Which of these conservation strategies focuses on protecting entire ecosystems?",
                                options: [
                                    "Captive breeding",
                                    "Seed banks",
                                    "Protected areas",
                                    "Species reintroduction"
                                ],
                                correct: 2,
                                explanation: "Protected areas like national parks and wildlife reserves focus on conserving entire ecosystems and their biodiversity."
                            },
                            {
                                question: "What is the term for the variety of genes within a species?",
                                options: [
                                    "Genetic diversity",
                                    "Species diversity",
                                    "Ecosystem diversity",
                                    "Biological diversity"
                                ],
                                correct: 0,
                                explanation: "Genetic diversity refers to the variety of genes within a species, which is important for adaptation and resilience."
                            },
                            {
                                question: "Which of these is an example of a keystone species?",
                                options: [
                                    "Sea otter",
                                    "Domestic dog",
                                    "Common earthworm",
                                    "House sparrow"
                                ],
                                correct: 0,
                                explanation: "Sea otters are a keystone species because they help maintain the balance of their ecosystem by controlling sea urchin populations."
                            },
                            {
                                question: "What is the main cause of the current high rate of species extinction?",
                                options: [
                                    "Natural disasters",
                                    "Human activities",
                                    "Climate change alone",
                                    "Disease outbreaks"
                                ],
                                correct: 1,
                                explanation: "Human activities, particularly habitat destruction and climate change, are the main drivers of the current high rate of species extinction."
                            },
                            {
                                question: "Which international agreement aims to protect biodiversity?",
                                options: [
                                    "Paris Agreement",
                                    "Kyoto Protocol",
                                    "Convention on Biological Diversity",
                                    "Montreal Protocol"
                                ],
                                correct: 2,
                                explanation: "The Convention on Biological Diversity is an international legal instrument for the conservation of biological diversity."
                            },
                            {
                                question: "What is the term for the variety of life at all levels of biological organization?",
                                options: [
                                    "Ecology",
                                    "Biodiversity",
                                    "Biology",
                                    "Ecosystem"
                                ],
                                correct: 1,
                                explanation: "Biodiversity refers to the variety of life at all levels of biological organization, from genes to ecosystems."
                            },
                            {
                                question: "Which of these is an example of an ecosystem service provided by biodiversity?",
                                options: [
                                    "Water purification",
                                    "Soil formation",
                                    "Climate regulation",
                                    "All of the above"
                                ],
                                correct: 3,
                                explanation: "Biodiversity provides essential ecosystem services including water purification, soil formation, and climate regulation."
                            },
                            {
                                question: "What is the estimated percentage of species that have been identified by scientists?",
                                options: [
                                    "Less than 20%",
                                    "About 50%",
                                    "About 80%",
                                    "More than 90%"
                                ],
                                correct: 0,
                                explanation: "Scientists estimate that less than 20% of species on Earth have been identified and described."
                            },
                            {
                                question: "Which of these factors does NOT contribute to biodiversity loss?",
                                options: [
                                    "Habitat fragmentation",
                                    "Sustainable agriculture",
                                    "Overexploitation",
                                    "Pollution"
                                ],
                                correct: 1,
                                explanation: "Sustainable agriculture practices can help maintain biodiversity, while the other options contribute to its loss."
                            },
                            {
                                question: "What is the term for species that are likely to become endangered in the near future?",
                                options: [
                                    "Endangered species",
                                    "Threatened species",
                                    "Vulnerable species",
                                    "Rare species"
                                ],
                                correct: 1,
                                explanation: "Threatened species are those that are likely to become endangered in the foreseeable future throughout all or a significant portion of their range."
                            },
                            {
                                question: "Which of these is a benefit of high biodiversity?",
                                options: [
                                    "Ecosystem stability",
                                    "Medical discoveries",
                                    "Agricultural resilience",
                                    "All of the above"
                                ],
                                correct: 3,
                                explanation: "High biodiversity contributes to ecosystem stability, provides sources for medical discoveries, and enhances agricultural resilience."
                            }
                        ]
                    }
                }
            },
            challenges: [
                { id: 1, title: 'Plastic-Free Day', description: 'Go one full day without using any single-use plastic items.', points: 50, completed: false },
                { id: 2, title: 'Energy Saver', description: 'Reduce your electricity consumption by 20% for one week.', points: 100, completed: false },
                { id: 3, title: 'Local Food Week', description: 'Eat only locally sourced food for one week.', points: 150, completed: false },
                { id: 4, title: 'Tree Planting Drive', description: 'Plant at least 5 trees in your community.', points: 200, completed: false },
                { id: 5, title: 'Water Conservation', description: 'Reduce your water usage by 25% for one month.', points: 120, completed: false }
            ]
        };


        // DOM Elements
        const loginSection = document.getElementById('login-section');
        const mainContent = document.getElementById('main-content');
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const userTypeSelectors = document.querySelectorAll('.user-type');
        const navLinks = document.querySelectorAll('.nav-link');
        const dashboardSections = document.querySelectorAll('.dashboard-section');
        const userRoleDisplay = document.getElementById('user-role-display');
        const usernameDisplay = document.getElementById('username-display');
        const userAvatar = document.getElementById('user-avatar');
        const ecoPointsDisplay = document.getElementById('eco-points');
        const currentLevelDisplay = document.getElementById('current-level');
        const completedChallengesDisplay = document.getElementById('completed-challenges');
        const badgesEarnedDisplay = document.getElementById('badges-earned');
        const progressPercent = document.getElementById('progress-percent');
        const levelProgressFill = document.getElementById('level-progress-fill');
        const currentUserName = document.getElementById('current-user-name');
        const currentUserPoints = document.getElementById('current-user-points');
        const currentUserBadges = document.getElementById('current-user-badges');
        const lessonModal = document.getElementById('lesson-modal');
        const lessonModalTitle = document.getElementById('lesson-modal-title');
        const lessonContent = document.getElementById('lesson-content');
        const quizModal = document.getElementById('quiz-modal');
        const quizModalTitle = document.getElementById('quiz-modal-title');
        const quizContent = document.getElementById('quiz-content');
        const closeModalBtns = document.querySelectorAll('.close-modal');
        const startLessonBtns = document.querySelectorAll('.start-lesson');
        const notification = document.getElementById('notification');
        const xpAnimation = document.getElementById('xp-animation');
        const climateProgress = document.getElementById('climate-progress');
        const wasteProgress = document.getElementById('waste-progress');
        const biodiversityProgress = document.getElementById('biodiversity-progress');
        const climateProgressFill = document.getElementById('climate-progress-fill');
        const wasteProgressFill = document.getElementById('waste-progress-fill');
        const biodiversityProgressFill = document.getElementById('biodiversity-progress-fill');

        // Teacher dashboard elements
        const totalStudents = document.getElementById('total-students');
        const completionRate = document.getElementById('completion-rate');
        const totalEcoPoints = document.getElementById('total-eco-points');
        const CollegeRank = document.getElementById('College-rank');

        // Current state
        let currentUser = null;
        let currentUserType = 'student';
        let currentLesson = null;
        let currentLessonStep = 0;
        let currentQuizAnswered = false;
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let quizScore = 0;
        let selectedQuestions = [];

        // Initialize the application
        function init() {
            // Check if user is already logged in (from localStorage)
            const savedUser = localStorage.getItem('ecolearnUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainContent();
            }

            // Set up event listeners
            setupEventListeners();
        }

        // Set up all event listeners
        function setupEventListeners() {
            // Login button
            loginBtn.addEventListener('click', handleLogin);
            
            // Logout button
            logoutBtn.addEventListener('click', handleLogout);
            
            // User type selection
            userTypeSelectors.forEach(selector => {
                selector.addEventListener('click', () => {
                    userTypeSelectors.forEach(s => s.classList.remove('active'));
                    selector.classList.add('active');
                    currentUserType = selector.dataset.type;
                });
            });
            
            // Navigation links
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const target = e.target.dataset.target;
                    showSection(target);
                });
            });
            
            // Start lesson buttons
            startLessonBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const lessonId = e.target.dataset.lesson;
                    startLesson(lessonId);
                });
            });
            
            // Close modal buttons
            closeModalBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal');
                    modal.style.display = 'none';
                    currentLessonStep = 0;
                    currentQuizAnswered = false;
                    currentQuestionIndex = 0;
                    quizScore = 0;
                    selectedQuestions = [];
                });
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === lessonModal) {
                    lessonModal.style.display = 'none';
                    currentLessonStep = 0;
                    currentQuizAnswered = false;
                }
                if (e.target === quizModal) {
                    quizModal.style.display = 'none';
                    currentQuestionIndex = 0;
                    quizScore = 0;
                    selectedQuestions = [];
                }
            });
            
            // Allow Enter key to trigger login
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
        }

        // Handle user login
        function handleLogin() {
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();
            
            if (!username || !password) {
                showNotification('Please enter both username and password', 'error');
                return;
            }
            
            // In a real app, this would be an API call to the backend
            // For demo purposes, we'll simulate authentication
            const user = ecoLearnDB.users.find(u => u.username === username);
            
            if (user && user.password === password) {
                if (user.role !== currentUserType) {
                    showNotification(`Please select ${user.role} role to login`, 'error');
                    return;
                }
                
                currentUser = user;
                localStorage.setItem('ecolearnUser', JSON.stringify(user));
                showMainContent();
                showNotification(`Welcome back, ${user.name}!`, 'success');
            } else {
                showNotification('Invalid username or password', 'error');
            }
        }

        // Handle user logout
        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('ecolearnUser');
            showLogin();
            usernameInput.value = '';
            passwordInput.value = '';
            showNotification('You have been logged out', 'info');
        }

        // Show login section
        function showLogin() {
            loginSection.classList.remove('hidden');
            mainContent.classList.add('hidden');
        }

        // Show main content after login
        function showMainContent() {
            loginSection.classList.add('hidden');
            mainContent.classList.remove('hidden');
            
            // Update UI with user data
            updateUserUI();
            
            // Show dashboard by default
            showSection('dashboard');
        }

        // Update UI with current user data
        function updateUserUI() {
            if (!currentUser) return;
            
            usernameDisplay.textContent = currentUser.name;
            userRoleDisplay.textContent = currentUser.role === 'teacher' ? 'Teacher' : 'Student';
            userAvatar.textContent = currentUser.name.split(' ').map(n => n[0]).join('');
            
            // Update stats
            ecoPointsDisplay.textContent = currentUser.points;
            currentLevelDisplay.textContent = currentUser.level || 1;
            completedChallengesDisplay.textContent = currentUser.challenges;
            badgesEarnedDisplay.textContent = currentUser.badges;
            
            // Update level progress correctly
            updateLevelProgress();
            
            // Update leaderboard
            currentUserName.textContent = currentUser.name;
            currentUserPoints.textContent = currentUser.points;
            currentUserBadges.textContent = currentUser.badges;
            
            // Update lesson progress
            if (currentUser.lessonProgress) {
                updateLessonProgress('climate', currentUser.lessonProgress.climate.progress);
                updateLessonProgress('waste', currentUser.lessonProgress.waste.progress);
                updateLessonProgress('biodiversity', currentUser.lessonProgress.biodiversity.progress);
            }
            
            // Update teacher dashboard if user is a teacher
            if (currentUser.role === 'teacher') {
                updateTeacherDashboard();
            }
            
            // Show/hide teacher dashboard link based on role
            const teacherLinks = document.querySelectorAll('.teacher-only');
            teacherLinks.forEach(link => {
                link.style.display = currentUser.role === 'teacher' ? 'block' : 'none';
            });
        }

        // Update level progress with correct calculation
        function updateLevelProgress() {
            if (!currentUser) return;
            
            const currentLevel = currentUser.level || 1;
            const pointsForCurrentLevel = (currentLevel - 1) * 100;
            const pointsInCurrentLevel = currentUser.points - pointsForCurrentLevel;
            const pointsNeededForNextLevel = 100; // Fixed 100 points per level
            const progressPercentage = Math.min(100, Math.round((pointsInCurrentLevel / pointsNeededForNextLevel) * 100));
            
            progressPercent.textContent = `${progressPercentage}%`;
            levelProgressFill.style.width = `${progressPercentage}%`;
            
            // Update the progress text
            const progressInfo = document.querySelector('.progress-info span:first-child');
            if (progressInfo) {
                progressInfo.textContent = `Next Level: Eco Warrior (Level ${currentLevel + 1})`;
            }
        }

        // Update lesson progress
        function updateLessonProgress(lessonId, progress) {
            const progressElement = document.getElementById(`${lessonId}-progress`);
            const progressFillElement = document.getElementById(`${lessonId}-progress-fill`);
            
            if (progressElement && progressFillElement) {
                progressElement.textContent = `${progress}%`;
                progressFillElement.style.width = `${progress}%`;
            }
        }

        // Update teacher dashboard with analytics
        function updateTeacherDashboard() {
            // Calculate teacher dashboard metrics
            const students = ecoLearnDB.users.filter(user => user.role === 'student');
            const totalPoints = students.reduce((sum, student) => sum + student.points, 0);
            const avgCompletionRate = students.length > 0 ? 
                Math.round(students.reduce((sum, student) => {
                    const lessonProgress = student.lessonProgress || {};
                    const totalProgress = Object.values(lessonProgress).reduce((s, p) => s + (p.progress || 0), 0);
                    const avgProgress = Object.keys(lessonProgress).length > 0 ? totalProgress / Object.keys(lessonProgress).length : 0;
                    return sum + avgProgress;
                }, 0) / students.length) : 0;
            
            // Update teacher dashboard elements
            if (totalStudents) totalStudents.textContent = students.length;
            if (completionRate) completionRate.textContent = `${avgCompletionRate}%`;
            if (totalEcoPoints) totalEcoPoints.textContent = totalPoints.toLocaleString();
            if (CollegeRank) CollegeRank.textContent = '3'; // This would come from backend in real app
        }

        // Show a specific section
        function showSection(sectionId) {
            // Hide all sections
            dashboardSections.forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show the selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // If showing teacher dashboard and user is not a teacher, redirect to dashboard
            if (sectionId === 'teacher-dashboard' && currentUser.role !== 'teacher') {
                showSection('dashboard');
                showNotification('Access denied. Teacher dashboard is for teachers only.', 'error');
            }
        }

        // Start a lesson
        function startLesson(lessonId) {
            currentLesson = lessonId;
            currentLessonStep = 0;
            
            const lesson = ecoLearnDB.lessons[lessonId];
            if (!lesson) return;
            
            lessonModalTitle.textContent = lesson.title;
            
            // Load the first step of the lesson
            loadLessonStep(lessonId, 0);
            
            // Show the modal
            lessonModal.style.display = 'flex';
        }

        // Load a specific step in the lesson
        function loadLessonStep(lessonId, stepIndex) {
            const lesson = ecoLearnDB.lessons[lessonId];
            if (!lesson || stepIndex >= lesson.content.length) {
                return;
            }
            
            const step = lesson.content[stepIndex];
            let contentHTML = step.data;
            
            lessonContent.innerHTML = contentHTML;
            
            // Set up quiz button if it exists
            const quizBtn = document.getElementById(`start-${lessonId}-quiz`);
            if (quizBtn) {
                quizBtn.addEventListener('click', () => {
                    startQuiz(lessonId);
                });
            }
        }

        // Start a quiz for a specific lesson
        function startQuiz(lessonId) {
            const lesson = ecoLearnDB.lessons[lessonId];
            if (!lesson || !lesson.quiz) return;
            
            currentQuiz = lesson.quiz;
            currentQuestionIndex = 0;
            quizScore = 0;
            
            // Select 10 random questions from the pool of 20
            selectedQuestions = [...lesson.quiz.questions]
                .sort(() => 0.5 - Math.random())
                .slice(0, 10);
            
            quizModalTitle.textContent = currentQuiz.title;
            
            // Load the first question
            loadQuizQuestion();
            
            // Show the quiz modal
            quizModal.style.display = 'flex';
            lessonModal.style.display = 'none';
        }

        // Load a specific question in the quiz
        function loadQuizQuestion() {
            if (!currentQuiz || currentQuestionIndex >= selectedQuestions.length) {
                // Quiz completed
                completeQuiz();
                return;
            }
            
            const question = selectedQuestions[currentQuestionIndex];
            let contentHTML = `
                <div class="quiz-progress">
                    <div class="question-counter">Question ${currentQuestionIndex + 1} of ${selectedQuestions.length}</div>
                    <div class="quiz-score">Score: ${quizScore}/${selectedQuestions.length}</div>
                </div>
                <div class="quiz-container">
                    <div class="quiz-question">${question.question}</div>
                    <div class="quiz-options">
            `;
            
            question.options.forEach((option, index) => {
                contentHTML += `<div class="quiz-option" data-index="${index}">${option}</div>`;
            });
            
            contentHTML += `
                    </div>
                    <button class="btn" id="submit-quiz" style="width: 100%; margin-top: 15px;">Submit Answer</button>
                    <div class="quiz-result" id="quiz-result"></div>
                </div>
            `;
            
            quizContent.innerHTML = contentHTML;
            
            // Set up event listeners for the current question
            setupQuizQuestion();
        }

        // Set up quiz functionality for the current question
        function setupQuizQuestion() {
            const options = document.querySelectorAll('.quiz-option');
            const submitBtn = document.getElementById('submit-quiz');
            const resultDiv = document.getElementById('quiz-result');
            
            // Reset quiz state
            options.forEach(option => {
                option.classList.remove('selected');
                option.addEventListener('click', function() {
                    if (currentQuizAnswered) return;
                    
                    options.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            resultDiv.className = 'quiz-result';
            resultDiv.style.display = 'none';
            currentQuizAnswered = false;
            
            // Set up submit button
            submitBtn.addEventListener('click', () => {
                if (currentQuizAnswered) {
                    // Move to next question
                    currentQuestionIndex++;
                    loadQuizQuestion();
                    return;
                }
                
                const selectedOption = document.querySelector('.quiz-option.selected');
                
                if (!selectedOption) {
                    showNotification('Please select an answer', 'error');
                    return;
                }
                
                const selectedIndex = parseInt(selectedOption.dataset.index);
                const question = selectedQuestions[currentQuestionIndex];
                const isCorrect = selectedIndex === question.correct;
                
                if (isCorrect) {
                    resultDiv.textContent = 'Correct! ' + question.explanation;
                    resultDiv.className = 'quiz-result success';
                    quizScore++;
                } else {
                    resultDiv.textContent = 'Incorrect. ' + question.explanation;
                    resultDiv.className = 'quiz-result failure';
                }
                
                resultDiv.style.display = 'block';
                currentQuizAnswered = true;
                submitBtn.textContent = 'Next Question';
            });
        }

        // Complete the quiz and show results
        function completeQuiz() {
            const percentage = Math.round((quizScore / selectedQuestions.length) * 100);
            let performanceClass = 'performance-poor';
            let performanceMessage = 'Keep studying! You can do better next time.';
            
            if (percentage >= 90) {
                performanceClass = 'performance-excellent';
                performanceMessage = 'Outstanding! You have excellent knowledge of this topic.';
            } else if (percentage >= 80) {
                performanceClass = 'performance-good';
                performanceMessage = 'Great job! You have a good understanding of this topic.';
            } else if (percentage >= 70) {
                performanceClass = 'performance-average';
                performanceMessage = 'Good effort! With a bit more study, you can improve.';
            }
            
            // Award points based on performance
            let pointsEarned = 0;
            if (percentage >= 90) pointsEarned = 100;
            else if (percentage >= 80) pointsEarned = 80;
            else if (percentage >= 70) pointsEarned = 60;
            else if (percentage >= 60) pointsEarned = 40;
            else pointsEarned = 20;
            
            // Update user data
            if (currentUser) {
                currentUser.points += pointsEarned;
                
                // Check for level up
                const oldLevel = currentUser.level || 1;
                const newLevel = Math.floor(currentUser.points / 100) + 1;
                if (newLevel > oldLevel) {
                    currentUser.level = newLevel;
                    showNotification(`Congratulations! You've reached Level ${newLevel}!`, 'success');
                }
                
                // Update quiz progress
                if (currentUser.quizProgress && currentUser.quizProgress[currentLesson]) {
                    currentUser.quizProgress[currentLesson].score = quizScore;
                    currentUser.quizProgress[currentLesson].totalQuestions = selectedQuestions.length;
                    currentUser.quizProgress[currentLesson].completed = true;
                }
                
                // Update lesson progress
                if (currentUser.lessonProgress && currentUser.lessonProgress[currentLesson]) {
                    // Increase progress by 20% for completing the quiz
                    currentUser.lessonProgress[currentLesson].progress = Math.min(100, currentUser.lessonProgress[currentLesson].progress + 20);
                    currentUser.lessonProgress[currentLesson].completed += 1;
                }
                
                localStorage.setItem('ecolearnUser', JSON.stringify(currentUser));
                updateUserUI();
                
                // Show XP animation
                showXPAnimation(pointsEarned);
            }
            
            const contentHTML = `
                <div class="quiz-results">
                    <h3>Quiz Complete!</h3>
                    <div class="score">${quizScore}/${selectedQuestions.length} (${percentage}%)</div>
                    <div class="performance-message ${performanceClass}">${performanceMessage}</div>
                    <p>You earned <strong>${pointsEarned} eco points</strong>!</p>
                    <button class="btn" id="close-quiz" style="margin-top: 20px;">Close Quiz</button>
                </div>
            `;
            
            quizContent.innerHTML = contentHTML;
            
            document.getElementById('close-quiz').addEventListener('click', () => {
                quizModal.style.display = 'none';
                currentQuestionIndex = 0;
                quizScore = 0;
                selectedQuestions = [];
            });
        }

        // Show XP animation
        function showXPAnimation(points) {
            xpAnimation.textContent = `+${points} XP`;
            xpAnimation.style.display = 'block';
            
            setTimeout(() => {
                xpAnimation.style.display = 'none';
            }, 2000);
        }

        // Show notification
        function showNotification(message, type = 'info') {
            notification.textContent = message;
            notification.style.display = 'block';
            
            // Set background color based on type
            if (type === 'error') {
                notification.style.backgroundColor = '#f44336';
            } else if (type === 'success') {
                notification.style.backgroundColor = '#4caf50';
            } else {
                notification.style.backgroundColor = '#2196f3';
            }
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
